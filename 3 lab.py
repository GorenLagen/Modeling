# Заданные значения p и q
p = 0
q = 0

# Вычисление сопротивлений и ЭДС
r = [p + q + k for k in range(1, 9)]
e = [2 * (p + q) + 20, 2 * (p + q) + 3, 3 * (p + q) + 8, 8 * (p + q) + 39]


# Функция для решения СЛАУ методом Крамера
def solve_linear_system(A, b):
    n = len(A)
    det_A = det(A)
    x = [0] * n
    for i in range(n):
        Ai = [row[:] for row in A]
        for j in range(n):
            Ai[j][i] = b[j]
        x[i] = det(Ai) / det_A
    return x


# Функция для вычисления определителя матрицы
def det(A):
    n = len(A)
    if n == 1:
        return A[0][0]
    else:
        d = 0
        for j in range(n):
            M = [row[:j] + row[j + 1 :] for row in A[1:]]
            d += ((-1) ** j) * A[0][j] * det(M)
        return d


# Задача 1: Определение токов в ветвях
A = [
    [1, 0, 0, 1, 1, 0, 0, 0],
    [-1, -1, 0, 0, 0, 1, 0, 0],
    [0, 1, -1, 0, 0, 0, 1, 0],
    [0, 0, 1, -1, 0, 0, 0, 1],
    [r[0], 0, 0, 0, -r[4], r[5], 0, 0],
    [0, r[1], 0, 0, 0, r[5], -r[6], 0],
    [0, 0, r[2], 0, 0, 0, r[6], -r[7]],
    [0, 0, 0, r[3], -r[4], 0, 0, r[7]],
]
b = [0, 0, 0, 0, e[0], e[1], e[2], e[3]]

i = solve_linear_system(A, b)

print("Токи в ветвях:")
for k in range(8):
    print(f"i{k+1} = {i[k]:.3f}")

# Задача 2: Определение ЭДС четвертого источника
i1 = 0.8 * i[0]  # Ток i1 равен 80% от полученного в задаче 1
e1 = 0.8 * e[0]
e2 = 0.8 * e[1]
e3 = 0.8 * e[2]

A = [
    [0, 0, 0, 1, 1, 0, 0, 0],
    [0, -1, 0, 0, 0, 1, 0, 0],
    [0, 1, -1, 0, 0, 0, 1, 0],
    [0, 0, 1, -1, 0, 0, 0, 1],
    [0, 0, 0, 0, -r[4], r[5], 0, 0],
    [0, r[1], 0, 0, 0, r[5], -r[6], 0],
    [0, 0, r[2], 0, 0, 0, r[6], -r[7]],
    [-1, 0, 0, r[3], -r[4], 0, 0, r[7]],
]
b = [i1, -i1, 0, 0, e1 - r[0] * i1, e2, e3, 0]

x = solve_linear_system(A, b)
e4 = x[0]

print(f"\nЭДС четвертого источника: e4 = {e4:.3f}")
